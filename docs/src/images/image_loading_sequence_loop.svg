<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1613px" preserveAspectRatio="none" style="width:1410px;height:1613px;background:#F9F9F9;" version="1.1" viewBox="0 0 1410 1613" width="1410px" zoomAndPan="magnify"><defs/><g><rect fill="#F9F9F9" height="1613" style="stroke:none;stroke-width:1;" width="1410" x="0" y="0"/><rect fill="none" height="483.9297" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="572.7495" x="661.5737" y="111.7266"/><rect fill="none" height="75.3984" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="502.061" x="671.5737" y="469.3203"/><rect fill="none" height="644.7266" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="1394.3242" x="10" y="609.6563"/><rect fill="none" height="179.6016" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="732.7505" x="661.5737" y="849.7188"/><rect fill="none" height="119.3359" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="562.7495" x="671.5737" y="873.8516"/><rect fill="none" height="234.0625" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="502.061" x="671.5737" y="1310.5156"/><g><title>Caliptra</title><rect fill="#000000" fill-opacity="0.00000" height="1508.9844" width="8" x="50.4224" y="52.5938"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="54" x2="54" y1="52.5938" y2="1561.5781"/></g><g><title>SHA Acc</title><rect fill="#000000" fill-opacity="0.00000" height="1508.9844" width="8" x="255.125" y="52.5938"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="258.9185" x2="258.9185" y1="52.5938" y2="1561.5781"/></g><g><title>Caliptra Mailbox</title><rect fill="#000000" fill-opacity="0.00000" height="1508.9844" width="8" x="471.1953" y="52.5938"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="474.4604" x2="474.4604" y1="52.5938" y2="1561.5781"/></g><g><title>MCU</title><rect fill="#000000" fill-opacity="0.00000" height="1508.9844" width="8" x="700.6245" y="52.5938"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="704.5737" x2="704.5737" y1="52.5938" y2="1561.5781"/></g><g><title>PLDM FW </title><rect fill="#000000" fill-opacity="0.00000" height="1508.9844" width="8" x="1104.3389" y="52.5938"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1108.043" x2="1108.043" y1="52.5938" y2="1561.5781"/></g><g><title>Flash</title><rect fill="#000000" fill-opacity="0.00000" height="1508.9844" width="8" x="1194.979" y="52.5938"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1198.6348" x2="1198.6348" y1="52.5938" y2="1561.5781"/></g><g><title>Vendor Component</title><rect fill="#000000" fill-opacity="0.00000" height="1508.9844" width="8" x="1305.3237" y="52.5938"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1309.3232" x2="1309.3232" y1="52.5938" y2="1561.5781"/></g><g class="participant participant-head" data-participant="Caliptra"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="68.8447" x="20" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.8447" x="27" y="41.292">Caliptra</text></g><g class="participant participant-tail" data-participant="Caliptra"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="68.8447" x="20" y="1560.5781"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.8447" x="27" y="1580.5732">Caliptra</text></g><g class="participant participant-head" data-participant="SHA"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="72.4131" x="222.9185" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.4131" x="229.9185" y="41.292">SHA Acc</text></g><g class="participant participant-tail" data-participant="SHA"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="72.4131" x="222.9185" y="1560.5781"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.4131" x="229.9185" y="1580.5732">SHA Acc</text></g><g class="participant participant-head" data-participant="Mailbox"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="127.4697" x="411.4604" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.4697" x="418.4604" y="41.292">Caliptra Mailbox</text></g><g class="participant participant-tail" data-participant="Mailbox"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="127.4697" x="411.4604" y="1560.5781"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.4697" x="418.4604" y="1580.5732">Caliptra Mailbox</text></g><g class="participant participant-head" data-participant="MCU"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="46.1016" x="681.5737" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.1016" x="688.5737" y="41.292">MCU</text></g><g class="participant participant-tail" data-participant="MCU"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="46.1016" x="681.5737" y="1560.5781"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.1016" x="688.5737" y="1580.5732">MCU</text></g><g class="participant participant-head" data-participant="PLDM"><rect fill="#E55756" height="46.5938" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="110.5918" x="1053.043" y="5"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.4473" x="1073.3901" y="24.9951">PLDM FW</text><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.5918" x="1060.043" y="41.292">Update Agent</text></g><g class="participant participant-tail" data-participant="PLDM"><rect fill="#E55756" height="46.5938" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="110.5918" x="1053.043" y="1560.5781"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.4473" x="1073.3901" y="1580.5732">PLDM FW</text><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.5918" x="1060.043" y="1596.8701">Update Agent</text></g><g class="participant participant-head" data-participant="Flash"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="50.6885" x="1173.6348" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.6885" x="1180.6348" y="41.292">Flash</text></g><g class="participant participant-tail" data-participant="Flash"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="50.6885" x="1173.6348" y="1560.5781"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.6885" x="1180.6348" y="1580.5732">Flash</text></g><g class="participant participant-head" data-participant="component"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="150.001" x="1234.3232" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.001" x="1241.3232" y="41.292">Vendor Component</text></g><g class="participant participant-tail" data-participant="component"><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="150.001" x="1234.3232" y="1560.5781"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.001" x="1241.3232" y="1580.5732">Vendor Component</text></g><g class="message" data-participant-1="MCU" data-participant-2="MCU"><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="746.6245" y1="83.7266" y2="83.7266"/><line style="stroke:#0000FF;stroke-width:1;" x1="746.6245" x2="746.6245" y1="83.7266" y2="96.7266"/><line style="stroke:#0000FF;stroke-width:1;" x1="705.6245" x2="746.6245" y1="96.7266" y2="96.7266"/><polygon fill="#0000FF" points="715.6245,92.7266,705.6245,96.7266,715.6245,100.7266,711.6245,96.7266" style="stroke:#0000FF;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260.8188" x="711.6245" y="78.6606">17. Initialize image_loader(boot_source)</text></g><path d="M665.0737,111.7266 L726.0166,111.7266 L726.0166,118.8594 L716.0166,128.8594 L661.5737,128.8594 L661.5737,115.2266 A3.5,3.5 0 0 1 665.0737,111.7266" fill="#EEEEEE" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="483.9297" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="572.7495" x="661.5737" y="111.7266"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="676.5737" y="124.7935">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="160.4829" x="741.0166" y="123.937">[18. boot_source = PLDM]</text><g class="message" data-participant-1="MCU" data-participant-2="MCU"><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="746.6245" y1="149.9922" y2="149.9922"/><line style="stroke:#0000FF;stroke-width:1;" x1="746.6245" x2="746.6245" y1="149.9922" y2="162.9922"/><line style="stroke:#0000FF;stroke-width:1;" x1="705.6245" x2="746.6245" y1="162.9922" y2="162.9922"/><polygon fill="#0000FF" points="715.6245,158.9922,705.6245,162.9922,715.6245,166.9922,711.6245,162.9922" style="stroke:#0000FF;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.9893" x="711.6245" y="144.9263">18.1.1. Start PLDM Service</text></g><g class="message" data-participant-1="PLDM" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,188.125,705.6245,192.125,715.6245,196.125,711.6245,192.125" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1107.3389" y1="192.125" y2="192.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.9165" x="721.6245" y="187.0591">18.1.2. QueryDeviceIdentifiers</text></g><g class="message" data-participant-1="MCU" data-participant-2="PLDM"><polygon fill="#0000FF" points="1096.3389,217.2578,1106.3389,221.2578,1096.3389,225.2578,1100.3389,221.2578" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="1102.3389" y1="221.2578" y2="221.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4087" x="711.6245" y="216.1919">18.1.3. DeviceIdentifiers</text></g><g class="message" data-participant-1="PLDM" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,246.3906,705.6245,250.3906,715.6245,254.3906,711.6245,250.3906" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1107.3389" y1="250.3906" y2="250.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.8125" x="721.6245" y="245.3247">18.1.4. GetFirmwareParameters</text></g><g class="message" data-participant-1="MCU" data-participant-2="PLDM"><polygon fill="#0000FF" points="1096.3389,275.5234,1106.3389,279.5234,1096.3389,283.5234,1100.3389,279.5234" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="1102.3389" y1="279.5234" y2="279.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.6436" x="711.6245" y="274.4575">18.1.5. FirmwareParameters</text></g><g class="message" data-participant-1="PLDM" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,304.6563,705.6245,308.6563,715.6245,312.6563,711.6245,308.6563" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1107.3389" y1="308.6563" y2="308.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.084" x="721.6245" y="303.5903">18.1.6. RequestUpdate</text></g><g class="message" data-participant-1="MCU" data-participant-2="PLDM"><polygon fill="#0000FF" points="1096.3389,333.7891,1106.3389,337.7891,1096.3389,341.7891,1100.3389,337.7891" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="1102.3389" y1="337.7891" y2="337.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.2358" x="711.6245" y="332.7231">18.1.7. RequestUpdate Response</text></g><g class="message" data-participant-1="PLDM" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,362.9219,705.6245,366.9219,715.6245,370.9219,711.6245,366.9219" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1107.3389" y1="366.9219" y2="366.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.126" x="721.6245" y="361.856">18.1.8. PassComponent(component)</text></g><g class="message" data-participant-1="MCU" data-participant-2="PLDM"><polygon fill="#0000FF" points="1096.3389,392.0547,1106.3389,396.0547,1096.3389,400.0547,1100.3389,396.0547" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="1102.3389" y1="396.0547" y2="396.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.5903" x="711.6245" y="390.9888">18.1.9. PassComponent Response</text></g><g class="message" data-participant-1="PLDM" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,421.1875,705.6245,425.1875,715.6245,429.1875,711.6245,425.1875" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1107.3389" y1="425.1875" y2="425.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.126" x="721.6245" y="420.1216">18.1.10. UpdateComponent(component)</text></g><g class="message" data-participant-1="MCU" data-participant-2="PLDM"><polygon fill="#0000FF" points="1096.3389,450.3203,1106.3389,454.3203,1096.3389,458.3203,1100.3389,454.3203" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="1102.3389" y1="454.3203" y2="454.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.5903" x="711.6245" y="449.2544">18.1.11. UpdateComponent Response</text></g><path d="M675.0737,469.3203 L748.1978,469.3203 L748.1978,476.4531 L738.1978,486.4531 L671.5737,486.4531 L671.5737,472.8203 A3.5,3.5 0 0 1 675.0737,469.3203" fill="#EEEEEE" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="75.3984" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="502.061" x="671.5737" y="469.3203"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="686.5737" y="482.3872">loop</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="218.856" x="763.1978" y="481.5308">[18.12. Retrieve TOC from offset 0]</text><g class="message" data-participant-1="MCU" data-participant-2="PLDM"><polygon fill="#0000FF" points="1096.3389,503.5859,1106.3389,507.5859,1096.3389,511.5859,1100.3389,507.5859" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="1102.3389" y1="507.5859" y2="507.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.4858" x="711.6245" y="502.52">18.1.1.1. RequestFirmwareData</text></g><g class="message" data-participant-1="PLDM" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,532.7188,705.6245,536.7188,715.6245,540.7188,711.6245,536.7188" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1107.3389" y1="536.7188" y2="536.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.583" x="721.6245" y="531.6528">18.1.1.2. Data (TOC)</text></g><line style="stroke:#393939;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="661.5737" x2="1234.3232" y1="552.7188" y2="552.7188"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="158.4204" x="666.5737" y="562.9292">[18. boot_source = Flash]</text><g class="message" data-participant-1="Flash" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,583.6563,705.6245,587.6563,715.6245,591.6563,711.6245,587.6563" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1197.979" y1="587.6563" y2="587.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.812" x="721.6245" y="582.5903">18.2. Read TOC from flash</text></g><path d="M13.5,609.6563 L86.624,609.6563 L86.624,616.7891 L76.624,626.7891 L10,626.7891 L10,613.1563 A3.5,3.5 0 0 1 13.5,609.6563" fill="#EEEEEE" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="644.7266" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="1394.3242" x="10" y="609.6563"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="25" y="622.7231">loop</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="232.3965" x="101.624" y="621.8667">[19. For every SOC image (image_id)]</text><g class="message" data-participant-1="MCU" data-participant-2="MCU"><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="746.6245" y1="647.9219" y2="647.9219"/><line style="stroke:#0000FF;stroke-width:1;" x1="746.6245" x2="746.6245" y1="647.9219" y2="660.9219"/><line style="stroke:#0000FF;stroke-width:1;" x1="705.6245" x2="746.6245" y1="660.9219" y2="660.9219"/><polygon fill="#0000FF" points="715.6245,656.9219,705.6245,660.9219,715.6245,664.9219,711.6245,660.9219" style="stroke:#0000FF;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324.9746" x="711.6245" y="642.856">19.1. image_loader.load_and_authorize(image_id)</text></g><g class="message" data-participant-1="MCU" data-participant-2="Mailbox"><polygon fill="#0000FF" points="486.1953,686.0547,476.1953,690.0547,486.1953,694.0547,482.1953,690.0547" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="480.1953" x2="703.6245" y1="690.0547" y2="690.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.4292" x="492.1953" y="684.9888">19.2. get_image_info(image_id)</text></g><g class="message" data-participant-1="Mailbox" data-participant-2="Caliptra"><polygon fill="#FF0000" points="65.4224,715.1875,55.4224,719.1875,65.4224,723.1875,61.4224,719.1875" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="59.4224" x2="474.1953" y1="719.1875" y2="719.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.4292" x="71.4224" y="714.1216">19.2. get_image_info(image_id)</text></g><g class="message" data-participant-1="Caliptra" data-participant-2="Mailbox"><polygon fill="#FF0000" points="463.1953,744.3203,473.1953,748.3203,463.1953,752.3203,467.1953,748.3203" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="54.4224" x2="469.1953" y1="748.3203" y2="748.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.7729" x="61.4224" y="743.2544">19.3. image_info {instance_id, load_address, component_id}</text></g><g class="message" data-participant-1="Mailbox" data-participant-2="MCU"><polygon fill="#0000FF" points="692.6245,773.4531,702.6245,777.4531,692.6245,781.4531,696.6245,777.4531" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="475.1953" x2="698.6245" y1="777.4531" y2="777.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.583" x="482.1953" y="772.3872">19.3. image_info</text></g><g class="message" data-participant-1="MCU" data-participant-2="MCU"><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="746.6245" y1="821.7188" y2="821.7188"/><line style="stroke:#0000FF;stroke-width:1;" x1="746.6245" x2="746.6245" y1="821.7188" y2="834.7188"/><line style="stroke:#0000FF;stroke-width:1;" x1="705.6245" x2="746.6245" y1="834.7188" y2="834.7188"/><polygon fill="#0000FF" points="715.6245,830.7188,705.6245,834.7188,715.6245,838.7188,711.6245,834.7188" style="stroke:#0000FF;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="389.7144" x="711.6245" y="801.52">19.4. image_offset = get_image_offset(TOC, component_id)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="328.9673" x="711.6245" y="816.6528">image_size = get_image_size(TOC, component_id)</text></g><path d="M665.0737,849.7188 L738.1978,849.7188 L738.1978,856.8516 L728.1978,866.8516 L661.5737,866.8516 L661.5737,853.2188 A3.5,3.5 0 0 1 665.0737,849.7188" fill="#EEEEEE" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="179.6016" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="732.7505" x="661.5737" y="849.7188"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="676.5737" y="862.7856">loop</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="514.728" x="753.1978" y="861.9292">[19.5. Transfer image in chunks (offset = image_offset..image_offset+image_size)]</text><path d="M675.0737,873.8516 L736.0166,873.8516 L736.0166,880.9844 L726.0166,890.9844 L671.5737,890.9844 L671.5737,877.3516 A3.5,3.5 0 0 1 675.0737,873.8516" fill="#EEEEEE" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="119.3359" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="562.7495" x="671.5737" y="873.8516"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="686.5737" y="886.9185">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="182.0854" x="751.0166" y="886.062">[19.5.1. boot_source = Flash]</text><g class="message" data-participant-1="Flash" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,908.1172,705.6245,912.1172,715.6245,916.1172,711.6245,912.1172" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1197.979" y1="912.1172" y2="912.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.542" x="721.6245" y="907.0513">19.5.1.1. Image/Cfg chunk</text></g><line style="stroke:#393939;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="671.5737" x2="1234.3232" y1="921.1172" y2="921.1172"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="184.1479" x="676.5737" y="931.3276">[19.5.2. boot_source = PLDM]</text><g class="message" data-participant-1="MCU" data-participant-2="PLDM"><polygon fill="#0000FF" points="1096.3389,952.0547,1106.3389,956.0547,1096.3389,960.0547,1100.3389,956.0547" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="1102.3389" y1="956.0547" y2="956.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254.6045" x="711.6245" y="950.9888">19.5.2.1. RequestFirmwareData(offset)</text></g><g class="message" data-participant-1="PLDM" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,981.1875,705.6245,985.1875,715.6245,989.1875,711.6245,985.1875" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1107.3389" y1="985.1875" y2="985.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.542" x="721.6245" y="980.1216">19.5.2.2. Image/Cfg chunk</text></g><g class="message" data-participant-1="MCU" data-participant-2="component"><polygon fill="#0000FF" points="1297.3237,1017.3203,1307.3237,1021.3203,1297.3237,1025.3203,1301.3237,1021.3203" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="1303.3237" y1="1021.3203" y2="1021.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.1348" x="711.6245" y="1016.2544">19.5.3. Write Image/Cfg chunk to load_address</text></g><g class="message" data-participant-1="MCU" data-participant-2="Mailbox"><polygon fill="#0000FF" points="486.1953,1053.4531,476.1953,1057.4531,486.1953,1061.4531,482.1953,1057.4531" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="480.1953" x2="703.6245" y1="1057.4531" y2="1057.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.4829" x="492.1953" y="1052.3872">19.6. authorize(image_id)</text></g><g class="message" data-participant-1="Mailbox" data-participant-2="Caliptra"><polygon fill="#FF0000" points="65.4224,1082.5859,55.4224,1086.5859,65.4224,1090.5859,61.4224,1086.5859" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="59.4224" x2="474.1953" y1="1086.5859" y2="1086.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.4829" x="71.4224" y="1081.52">19.6. authorize(image_id)</text></g><g class="message" data-participant-1="component" data-participant-2="SHA"><polygon fill="#FF0000" points="270.125,1111.7188,260.125,1115.7188,270.125,1119.7188,266.125,1115.7188" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="264.125" x2="1308.3237" y1="1115.7188" y2="1115.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.2095" x="276.125" y="1110.6528">19.7. Image/Cfg</text></g><g class="message" data-participant-1="Caliptra" data-participant-2="Caliptra"><line style="stroke:#FF0000;stroke-width:1;" x1="54.4224" x2="96.4224" y1="1175.1172" y2="1175.1172"/><line style="stroke:#FF0000;stroke-width:1;" x1="96.4224" x2="96.4224" y1="1175.1172" y2="1188.1172"/><line style="stroke:#FF0000;stroke-width:1;" x1="55.4224" x2="96.4224" y1="1188.1172" y2="1188.1172"/><polygon fill="#FF0000" points="65.4224,1184.1172,55.4224,1188.1172,65.4224,1192.1172,61.4224,1188.1172" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.5703" x="61.4224" y="1139.7856">19.8. Verify Hash in SHA Acc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.7715" x="61.4224" y="1154.9185">with SOC Manifest Hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.8628" x="65.5547" y="1170.0513">for image_id</text></g><g class="message" data-participant-1="Caliptra" data-participant-2="Mailbox"><polygon fill="#FF0000" points="463.1953,1213.25,473.1953,1217.25,463.1953,1221.25,467.1953,1217.25" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="54.4224" x2="469.1953" y1="1217.25" y2="1217.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.1445" x="61.4224" y="1212.1841">19.9. Return success</text></g><g class="message" data-participant-1="Mailbox" data-participant-2="MCU"><polygon fill="#0000FF" points="692.6245,1242.3828,702.6245,1246.3828,692.6245,1250.3828,696.6245,1246.3828" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="475.1953" x2="698.6245" y1="1246.3828" y2="1246.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.54" x="482.1953" y="1241.3169">19.9. Success</text></g><g class="message" data-participant-1="MCU" data-participant-2="MCU"><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="746.6245" y1="1282.5156" y2="1282.5156"/><line style="stroke:#0000FF;stroke-width:1;" x1="746.6245" x2="746.6245" y1="1282.5156" y2="1295.5156"/><line style="stroke:#0000FF;stroke-width:1;" x1="705.6245" x2="746.6245" y1="1295.5156" y2="1295.5156"/><polygon fill="#0000FF" points="715.6245,1291.5156,705.6245,1295.5156,715.6245,1299.5156,711.6245,1295.5156" style="stroke:#0000FF;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.9644" x="711.6245" y="1277.4497">20. Deinitialize image_loader (finalize)</text></g><path d="M675.0737,1310.5156 L736.0166,1310.5156 L736.0166,1317.6484 L726.0166,1327.6484 L671.5737,1327.6484 L671.5737,1314.0156 A3.5,3.5 0 0 1 675.0737,1310.5156" fill="#EEEEEE" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="234.0625" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="502.061" x="671.5737" y="1310.5156"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="686.5737" y="1323.5825">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="160.4829" x="751.0166" y="1322.7261">[21. boot_source = PLDM]</text><g class="message" data-participant-1="MCU" data-participant-2="PLDM"><polygon fill="#0000FF" points="1096.3389,1344.7813,1106.3389,1348.7813,1096.3389,1352.7813,1100.3389,1348.7813" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="1102.3389" y1="1348.7813" y2="1348.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.979" x="711.6245" y="1343.7153">21.1. VerifyComplete</text></g><g class="message" data-participant-1="PLDM" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,1373.9141,705.6245,1377.9141,715.6245,1381.9141,711.6245,1377.9141" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1107.3389" y1="1377.9141" y2="1377.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.1309" x="721.6245" y="1372.8481">21.2. VerifyComplete Response</text></g><g class="message" data-participant-1="MCU" data-participant-2="PLDM"><polygon fill="#0000FF" points="1096.3389,1403.0469,1106.3389,1407.0469,1096.3389,1411.0469,1100.3389,1407.0469" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="1102.3389" y1="1407.0469" y2="1407.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.5635" x="711.6245" y="1401.981">21.3. ApplyComplete</text></g><g class="message" data-participant-1="PLDM" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,1432.1797,705.6245,1436.1797,715.6245,1440.1797,711.6245,1436.1797" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1107.3389" y1="1436.1797" y2="1436.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.7153" x="721.6245" y="1431.1138">21.4. ApplyComplete Response</text></g><g class="message" data-participant-1="PLDM" data-participant-2="MCU"><polygon fill="#0000FF" points="715.6245,1461.3125,705.6245,1465.3125,715.6245,1469.3125,711.6245,1465.3125" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="709.6245" x2="1107.3389" y1="1465.3125" y2="1465.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.7144" x="721.6245" y="1460.2466">21.5. Activate</text></g><g class="message" data-participant-1="MCU" data-participant-2="PLDM"><polygon fill="#0000FF" points="1096.3389,1490.4453,1106.3389,1494.4453,1096.3389,1498.4453,1100.3389,1494.4453" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="1102.3389" y1="1494.4453" y2="1494.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.8662" x="711.6245" y="1489.3794">21.6. Activate Response</text></g><g class="message" data-participant-1="MCU" data-participant-2="MCU"><line style="stroke:#0000FF;stroke-width:1;" x1="704.6245" x2="746.6245" y1="1523.5781" y2="1523.5781"/><line style="stroke:#0000FF;stroke-width:1;" x1="746.6245" x2="746.6245" y1="1523.5781" y2="1536.5781"/><line style="stroke:#0000FF;stroke-width:1;" x1="705.6245" x2="746.6245" y1="1536.5781" y2="1536.5781"/><polygon fill="#0000FF" points="715.6245,1532.5781,705.6245,1536.5781,715.6245,1540.5781,711.6245,1536.5781" style="stroke:#0000FF;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.3833" x="711.6245" y="1518.5122">21.7. Stop PLDM Service</text></g><!--SRC=[bLPjRzem4FwUNt7hf0cqBYjfDygaLa9Kh9M6rfM-V5Whv2OEM0jEPZljkcd_VMSx2Ga9WL5LXFXvxiw-UyxtIYteaiAI2EaaH2ZciuHm1NiZ4h542R87H4B-emgPdWzXwFi6WS_DV9WG5Zt6lmmgUwuY9wCRkpYwgIvSVZcRmFWExlbD4X15OJYdN1ciNgg2nn6H2xDcdggBjvG7iO1Hl4nYdjlmyr-EWwxVVN_z6ANquHIVFq6lxy85PuhXBdvJO4iofxCe9W4LdSSuLZCPfyAdNSSXaOBUiGkbjt1YumFyr2qVkptyWwd200qEfbGyCPywXg3VD30y5xwbLBoSKGsz231i5Z8g943DZpQHqGvTg35Q_Hovy9cgCHFBPoBe9H5aITLMDnzSg5DQ_NnquOh-JAbKMMvRxVVNqLTKOkva-vbXLYw9b4NMEqN6k-tk1cl4tTpr3bomuVs_nrwlnbrp6iLnOh2UFWib67sYSFrr1A68bn27eQGA3WoqpOyklUmeyuoT4KMowDfsfqlGG3lejMlWg2eJb-FGID866LWfQgXvgfarUo71QX-X8Q1Tnx4RnbICKRcuMV42KuGPAKB7Af85tGqg6-YDbcNhwgyPuVYVgaKiKDOb8tKhjbCPInZbdAfPXkPXl29cv_Ocxsp85pHuECsxtpQ-TPoZStRP-M6-3Ks4FunBHRYloVjWjnG4Wagvl-fdkFQt8R3gyLJiEXjFyIY7PHLsKjgAVQNBeUgyUyyjGEhUMMRe5mtuSeKFT3Ev5eJBa8eisuo3lqZv3mcT8eno2AvR_lLsvQjRLBLfqzfsRtEDvf-cMhLK95zeu-z7uTo6L12j0ZJCstWPj8ZJ4fl5cMswMnBf1g5QArvBbAYifYYAT6H6i3hk1CD6ksO8L5ofkhKsqAOYxFWDojj9GCrKwww8F6VY9698_T8fDCkiuWDxroqLB7o1Syo-BhbilC7nuvcfXMa-4y9PYDanc7iEOIno5GNRfJmmdJiL76Jg-tXwMqMAZAc5Egj3hidKEz2tF6iULw0JCcvUPyEArzjfMB5rwPcQjmUZRwQ85bTrlVmySqUiWQktMAC7BBPXaaGxEJXQnswxcZqpdGnznPxQnWpFZ2G5R7FKkT6-7k6mOLKcE4pIFm00]--></g></svg>