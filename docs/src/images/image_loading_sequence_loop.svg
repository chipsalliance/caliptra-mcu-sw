<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="535px" preserveAspectRatio="none" style="width:908px;height:535px;background:#F9F9F9;" version="1.1" viewBox="0 0 908 535" width="908px" zoomAndPan="magnify"><defs/><g><rect fill="#F9F9F9" height="535" style="stroke:none;stroke-width:1;" width="908" x="0" y="0"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="39.4224" x2="39.4224" y1="52.5938" y2="483.125"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="231.7217" x2="231.7217" y1="52.5938" y2="483.125"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="341.6631" x2="341.6631" y1="52.5938" y2="483.125"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="520.7427" x2="520.7427" y1="52.5938" y2="483.125"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="609.0894" x2="609.0894" y1="52.5938" y2="483.125"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="699.7295" x2="699.7295" y1="52.5938" y2="483.125"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="827.939" x2="827.939" y1="52.5938" y2="483.125"/><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="68.8447" x="5" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.8447" x="12" y="41.292">Caliptra</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="72.4131" x="195.5151" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.4131" x="202.5151" y="41.292">SHA Acc</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="127.4697" x="277.9282" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.4697" x="284.9282" y="41.292">Caliptra Mailbox</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="46.1016" x="497.6919" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.1016" x="504.6919" y="41.292">MCU</text><rect fill="#E55756" height="46.5938" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="110.5918" x="553.7935" y="5"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.4473" x="574.1406" y="24.9951">PLDM FW</text><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.5918" x="560.7935" y="41.292">Update Agent</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="50.6885" x="674.3853" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.6885" x="681.3853" y="41.292">Flash</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="150.001" x="752.9385" y="21.2969"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.001" x="759.9385" y="41.292">Vendor Component</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="68.8447" x="5" y="483.125"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.8447" x="12" y="503.1201">Caliptra</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="72.4131" x="195.5151" y="483.125"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.4131" x="202.5151" y="503.1201">SHA Acc</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="127.4697" x="277.9282" y="483.125"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.4697" x="284.9282" y="503.1201">Caliptra Mailbox</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="46.1016" x="497.6919" y="483.125"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.1016" x="504.6919" y="503.1201">MCU</text><rect fill="#E55756" height="46.5938" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="110.5918" x="553.7935" y="483.125"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.4473" x="574.1406" y="503.1201">PLDM FW</text><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.5918" x="560.7935" y="519.417">Update Agent</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="50.6885" x="674.3853" y="483.125"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.6885" x="681.3853" y="503.1201">Flash</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="150.001" x="752.9385" y="483.125"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.001" x="759.9385" y="503.1201">Vendor Component</text><path d="M26.9224,64.5938 L100.0464,64.5938 L100.0464,71.7266 L90.0464,81.7266 L23.4224,81.7266 L23.4224,68.0938 A3.5,3.5 0 0 1 26.9224,64.5938 " fill="#EEEEEE" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="394.5313" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="845.5166" x="23.4224" y="64.5938"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="38.4224" y="77.6606">loop</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="137.3335" x="115.0464" y="76.8042">[for every SOC image]</text><path d="M596.5894,95.7266 L657.5322,95.7266 L657.5322,102.8594 L647.5322,112.8594 L593.0894,112.8594 L593.0894,99.2266 A3.5,3.5 0 0 1 596.5894,95.7266 " fill="#EEEEEE" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="116.2031" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1;" width="250.8496" x="593.0894" y="95.7266"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="608.0894" y="108.7935">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="45.2031" x="672.5322" y="107.937">[PLDM]</text><line style="stroke:#393939;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="593.0894" x2="843.939" y1="162.9922" y2="162.9922"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="43.1406" x="598.0894" y="175.2026">[Flash]</text><polygon fill="#0000FF" points="815.939,139.9922,825.939,143.9922,815.939,147.9922,819.939,143.9922" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="609.0894" x2="821.939" y1="143.9922" y2="143.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.2095" x="616.0894" y="138.9263">19.1. Image/Cfg</text><polygon fill="#0000FF" points="815.939,199.9297,825.939,203.9297,815.939,207.9297,819.939,203.9297" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="699.7295" x2="821.939" y1="203.9297" y2="203.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.2095" x="706.7295" y="198.8638">19.2. Image/Cfg</text><polygon fill="#0000FF" points="352.6631,243.0625,342.6631,247.0625,352.6631,251.0625,348.6631,247.0625" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="346.6631" x2="519.7427" y1="247.0625" y2="247.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.0796" x="358.6631" y="241.9966">20. authorize(image_id)</text><polygon fill="#FF0000" points="242.7217,272.1953,232.7217,276.1953,242.7217,280.1953,238.7217,276.1953" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="236.7217" x2="826.939" y1="276.1953" y2="276.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.8062" x="248.7217" y="271.1294">21. Image/Cfg</text><line style="stroke:#FF0000;stroke-width:1;" x1="39.4224" x2="81.4224" y1="335.5938" y2="335.5938"/><line style="stroke:#FF0000;stroke-width:1;" x1="81.4224" x2="81.4224" y1="335.5938" y2="348.5938"/><line style="stroke:#FF0000;stroke-width:1;" x1="40.4224" x2="81.4224" y1="348.5938" y2="348.5938"/><polygon fill="#FF0000" points="50.4224,344.5938,40.4224,348.5938,50.4224,352.5938,46.4224,348.5938" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.167" x="46.4224" y="300.2622">22. Verify Hash in SHA Acc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.7715" x="46.4224" y="315.395">with SOC Manifest Hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.8628" x="50.5547" y="330.5278">for image_id</text><polygon fill="#FF0000" points="329.6631,373.7266,339.6631,377.7266,329.6631,381.7266,333.6631,377.7266" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="39.4224" x2="335.6631" y1="377.7266" y2="377.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.7412" x="46.4224" y="372.6606">23. Return success</text><polygon fill="#0000FF" points="508.7427,373.7266,518.7427,377.7266,508.7427,381.7266,512.7427,377.7266" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="341.6631" x2="514.7427" y1="377.7266" y2="377.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.3301" x="348.6631" y="372.6606">Success</text><polygon fill="#0000FF" points="50.4224,417.9922,40.4224,421.9922,50.4224,425.9922,46.4224,421.9922" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="44.4224" x2="519.7427" y1="421.9922" y2="421.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.2026" x="56.4224" y="401.7935">24. Set EXEC/Go Bit of component</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.5322" x="56.4224" y="416.9263">corresponding to image_id</text><polygon fill="#FF0000" points="815.939,447.125,825.939,451.125,815.939,455.125,819.939,451.125" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="39.4224" x2="821.939" y1="451.125" y2="451.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.5537" x="46.4224" y="446.0591">25. Go wire set</text><!--SRC=[TLBHJjj047o_hnX0gje7J4dfG_E054mebHeL4OKYaGWTzjevoRwpxjQbvEivN-maZiABTUkPtPsRkIDUKaaefNMYafPLeYgf6SUnB5J5LXv3EdH5dpAz7M6K987XpuVxCP6gU37_0wizzvcJUBO6uvaGVUZkz_K4DtynrxCgbKmOvQGvi1keJxuff5i6B9pwu0Ffr5Z4fgoCxcOaNUNtYiAO2fddq3-oRvZ-YQ5AcPEG1Q-t7LLMvgK4arc1RKsY-NtwTF9IrBIut4mRuln7T1xXLzD-5cUv45GuQcM5xmTDWzqchrXuJpRKrhmX1byZo9gNngeLVGuYdrNwHMnc-HPBwUBIX-BPFILTB1sbgptFBtyWgx8tt7g5K1fjmDx-LyNBOCb4QfMHuy2Pws1Of-20GVlhjdVu5k6UkBOQhauISavywfx7ziRnR8Xf2-zQiQFw8iAK6EF7SNpsq-1ACKosJNQk4sCjEL-bIkTWivMxBsudYy7t27xQgx84HznaWUQ1l0C0]--></g></svg>